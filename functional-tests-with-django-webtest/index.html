<!DOCTYPE html>
<html lang="en">
<head>

    <!-- Basic Page Needs
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <meta charset="utf-8">
    <title>Functional tests with django-webtest | blog.danclaudiupop | Software Testing and more</title>
    <meta name="description" content="blog.danclaudiupop, Software Testing and more">
    <meta name="author" content="danclaudiupop">

    <!-- Mobile Specific Metas
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Feeds
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <link rel="alternate" href="http://localhost:8000/feeds/all.atom.xml" type="application/atom+xml" title="blog.danclaudiupop Atom Feed" />

    <!-- FONT
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Inconsolata">

    <!-- CSS
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.3/normalize.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.css">
    <link rel="stylesheet" href="http://blog.danclaudiupop.com/theme/css/custom.css">
    <link rel="stylesheet" href="http://blog.danclaudiupop.com/theme/css/pygments.css">

    <!-- Scripts
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fitvids/1.1.0/jquery.fitvids.js"></script>
    <script>
        $(document).ready(function(){
            $(".container").fitVids();
        });
    </script>

    <!-- Favicon
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <link rel="icon" type="image/png" href="http://blog.danclaudiupop.com/theme/assets/favicon.png">

</head>
<body>

    <!-- Primary Page Layout
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <div class="container">
        <section class="header">
            <img src="http://blog.danclaudiupop.com/theme/assets/stewie.jpg" class="logo">
        </section>
    </div>
    <div class="container">
        <nav class="navbar">
            <div class="container">
                <ul class="navbar-list">
                    <li class="navbar-item"><a href="http://blog.danclaudiupop.com/" class="navbar-link">Posts</a></li>
                    <li class="navbar-item"><a href="http://blog.danclaudiupop.com/about-us.html" class="navbar-link">About</a></li>
                    <li class="navbar-icon">
                        <a href="http://blog.danclaudiupop.com/feeds/all.atom.xml">
                            <i class="fa fa-rss fa-fw fa-2x"></i>
                        </a>
                    </li>
                    <li class="navbar-icon">
                        <a href="https://github.com/danclaudiupop/">
                            <i class="fa fa-github fa-fw fa-2x"></i>
                        </a>
                    </li>
                    <li class="navbar-icon">
                        <a href="https://twitter.com/danclaudiupop">
                            <i class="fa fa-twitter fa-fw fa-2x"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
    </div>
    <div class="container">
        <section class="post">
            <header class="post-header">
                <h3>Functional tests with django-webtest</h3>
                <p class="post-meta">
                    Jo 25 aprilie 2013 &middot; tagged 
                        <a class="post-category" href="http://blog.danclaudiupop.com/tag/functional.html">functional</a>
                        <a class="post-category" href="http://blog.danclaudiupop.com/tag/django-webtest.html">django-webtest</a>
                </p>
            </header>
        </section>
        <section class="post-content">
            <p>I’ve been watching both presentations that Carl Meyer held at Pycon 2012/13 and
I highly recommend them if you want a deep dive into writing tests with django.
They outline some very good principles for writing effective and maintainable
tests. They also highlight a suite of test utilities and frameworks which help
you in writing better tests. Among the others, Webtest caught my attention via
<a class="reference external" href="https://github.com/kmike/django-webtest">django-webtest</a> for writing
integration/functional tests.</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">testLoginProcess</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">login</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">&#39;auth_login&#39;</span><span class="p">))</span>
    <span class="n">login</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">&#39;username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;danu&#39;</span>
    <span class="n">login</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">&#39;password&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;test123&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">login</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="s">&#39;Log in&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">follow</span><span class="p">()</span>
    <span class="n">assert_equals</span><span class="p">(</span><span class="s">&#39;200 OK&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
    <span class="n">assert_contains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s">&#39;Welcome danu :]&#39;</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">testLoginWithInvalidCredentials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">login</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">&#39;auth_login&#39;</span><span class="p">))</span>
    <span class="n">login</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">&#39;username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;foo&#39;</span>
    <span class="n">login</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">&#39;password&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;bar&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">login</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="s">&#39;Log in&#39;</span><span class="p">)</span>
    <span class="n">assert_contains</span><span class="p">(</span>
        <span class="n">response</span><span class="p">,</span>
        <span class="s">&#39;Please enter a correct username and password. &#39;</span>
        <span class="s">&#39;Note that both fields are case-sensitive.&#39;</span><span class="p">,</span>
        <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">status_code</span><span class="o">=</span><span class="mi">200</span>
    <span class="p">)</span>
</pre></div>
<p><strong>Why you should choose django-webtest instead of django client ?</strong>  Well,
first of all, it can better capture the user experience mainly because you can
submit forms and follow links. You are not only testing the views but also the
template html. Secondly, it will allow you to write more simple and readable
tests, an important fact when it comes to integration or functional tests.</p>
<p>It interacts with django via the WSGI interface so ajax, js will not be tested.
For that purpose you normally use selenium.</p>
<p>I’ve set up a project on <a class="reference external" href="https://github.com/danclaudiupop/django-lab-tests">github</a> to illustrate some
automated tests with django-webtest. It uses nose test suite runner since i
don’t want to to import all my tests into tests/__init__.py and for rest of the
goodness that nose offers.</p>

        </section>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'danclaudiupop';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><footer class="footer">
    &copy; blog.danclaudiupop &ndash;
        Proudly published with <a href="http://blog.getpelican.com/">Pelican</a>
</footer>    </div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-62968573-1', 'auto');
  ga('send', 'pageview');

</script>
    <!-- End Document
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
</body>
</html>
